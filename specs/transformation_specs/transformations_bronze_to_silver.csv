source_table,target_table,transformation_name,description,expression_sql,notes
bronze.orders_raw,silver.fact_order,type_cast_amount,"Cast order amount to DECIMAL","CAST(total_amount AS DECIMAL(12,2))","Handle non-numeric via expectation"
bronze.orders_raw,silver.fact_order,parse_order_ts,"Parse timestamp to UTC","to_timestamp(order_timestamp) AT TIME ZONE 'UTC'","Handle invalid via quarantine"
bronze.orders_raw,silver.fact_order,normalize_currency,"Uppercase currency code","upper(currency_code)","ISO set validation"
bronze.orders_raw,silver.fact_order,normalize_status,"Map raw status to conformed set","CASE status WHEN 'shipped' THEN 'SHIPPED' ... END","Define canonical list"
bronze.orders_raw,silver.fact_order,deduplicate_orders,"Drop duplicates by latest ingest","ROW_NUMBER() OVER (PARTITION BY order_id ORDER BY _ingest_time DESC) = 1","Use _record_hash if available"
bronze.order_items_raw,silver.fact_order_item,type_cast_item_fields,"Cast quantity/prices","CAST(quantity AS INT), CAST(unit_price AS DECIMAL(12,2))","Nulls become 0 if desired"
bronze.order_items_raw,silver.fact_order_item,derive_extended_amount,"Compute line total","quantity * unit_price","Excludes tax/discount"
bronze.customers_raw,silver.dim_customer,parse_customer_ts,"Parse created/updated timestamps","to_timestamp(created_at), to_timestamp(updated_at)","UTC normalization"
bronze.customers_raw,silver.dim_customer,scd2_changes,"Apply SCD2 on customer attributes","APPLY CHANGES INTO dim_customer ...","Use business key customer_id"
bronze.customers_raw,silver.dim_customer,normalize_country,"Conform ISO country","upper(trim(country_code))","Map aliases"
bronze.products_raw,silver.dim_product,cast_product_fields,"Cast list_price/is_active","CAST(list_price AS DECIMAL(12,2)), CAST(is_active AS BOOLEAN)","Handle true/false variants"
bronze.web_events_raw,silver.fact_web_event,parse_event_ts,"Parse event timestamp to UTC","to_timestamp(event_timestamp) AT TIME ZONE 'UTC'","Late/out-of-order handling"
bronze.web_events_raw,silver.fact_web_event,normalize_event_type,"Map raw event types","CASE event_type WHEN 'view' THEN 'VIEW' ... END","Define canonical list"
bronze.payments_raw,silver.fact_order,join_payment_status,"Enrich orders with payment_status","LEFT JOIN payments ON order_id","Prefer latest paid_at"